<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Coding for Modularity</title><link rel="stylesheet" href="taoup.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.58.1"/><link rel="home" href="index.html" title="The Art of Unix Programming"/><link rel="up" href="modularitychapter.html" title="Chapter 4. Modularity"/><link rel="previous" href="unix_and_oo.html" title="Unix and Object-Oriented Languages"/><link rel="next" href="textualitychapter.html" title="Chapter 5. Textuality"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Coding for Modularity</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="unix_and_oo.html">Prev</a> </td><th width="60%" align="center">Chapter 4. Modularity</th><td width="20%" align="right"> <a accesskey="n" href="textualitychapter.html">Next</a></td></tr></table><hr/></div><div class="sect1" lang="en"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="id2900840"/>Coding for Modularity</h2></div></div><p>Modularity is expressed in good code, but it primarily comes
from good design.  Here are some questions to ask about any code you 
work on that might help you improve its modularity:</p><div class="itemizedlist"><ul type="disc"><li><p>How many global variables does it have?  Global variables are
modularity poison, an easy way for components to leak information to
each other in careless and promiscuous ways.<sup>[<a id="id2900865" href="#ftn.id2900865">48</a>]</sup></p></li><li><p>Is the size of your individual modules in Hatton's sweet spot?  If your
answer is &#8220;No, many are larger&#8221;, you may have a long-term
maintenance problem.  Do you know what your own sweet spot is?  Do
you know what it is for other programmers you are cooperating with?
If not, best be conservative and stick to sizes near the low end of
Hatton's range.</p></li><li><p>Are the individual functions in your modules too large?  This
is not so much a matter of line count as it is of internal complexity.  If you
can't informally describe a function's contract with its callers in
one line, the function is probably too large.<sup>[<a id="id2900903" href="#ftn.id2900903">49</a>]</sup></p><div class="blockquote"><table border="0" width="100%" cellspacing="0" cellpadding="0" class="blockquote" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>Personally I tend to break up a subprogram when there are too many
local variables.  Another clue is [too many] levels of indentation.
I rarely look at length.</p></td><td width="10%" valign="top"> </td></tr><tr><td colspan="2" align="right" valign="top">--<span class="attribution">
<span class="author">Ken Thompson</span>
<a id="id2900935" class="indexterm"/>
</span></td><td width="10%" valign="top"> </td></tr></table></div></li><li><p>Does your code have internal APIs &#8212; that is, collections
of function calls and data structures that you can describe to others
as units, each sealing off some layer of function from the rest of the
code?  A good API makes sense and is understandable without looking at
the implementation behind it.  The classic test is this: Try to
describe it to another programmer over the phone.  If you fail, it
is very probably too complex, and poorly designed.</p></li><li><p>Do any of your APIs have more than seven entry points?  Do any
of your classes have more than seven methods each?  Do your data
structures have more than seven members?</p></li><li><p>What is the distribution of the number of entry points per
module across the project?<sup>[<a id="id2900990" href="#ftn.id2900990">50</a>]</sup>
Does it seem uneven?  Do the modules with lots of entry points really
need that many? Module complexity tends to rise as the square of the
number of entry points, too &#8212; yet another reason simple APIs are
better than complicated ones.</p></li></ul></div><p>You might find it instructive to compare these with our
checklist of questions about
transparency<a id="id2901027" class="indexterm"/>,
and
discoverability<a id="id2901036" class="indexterm"/>
in <a href="transparencychapter.html" title="Chapter 6. Transparency">Chapter 6</a>.</p><div class="footnotes"><br/><hr width="100" align="left"/><div class="footnote"><p><sup>[<a id="ftn.id2900865" href="#id2900865">48</a>] </sup>Globals
also mean your code cannot be reentrant; that is, multiple instances in the
same process are likely to step on each
other.</p></div><div class="footnote"><p><sup>[<a id="ftn.id2900903" href="#id2900903">49</a>] </sup>Many
years ago, I learned from Kernighan &amp; Plauger's
<i>The Elements of Programming Style</i> a useful
rule.  Write that one-line comment immediately after the prototype of
your function.  For <span class="emphasis"><em>every</em></span> function, without
exception.</p></div><div class="footnote"><p><sup>[<a id="ftn.id2900990" href="#id2900990">50</a>] </sup>A cheap way to collect this
information is to analyze the tags files generated by a utility like
etags(1)
or
ctags(1).</p></div></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="unix_and_oo.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="modularitychapter.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="textualitychapter.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Unix and Object-Oriented Languages </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 5. Textuality</td></tr></table></div></body></html>
